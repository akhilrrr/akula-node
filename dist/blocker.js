!function(){"use strict";const t=document.currentScript,e=t?t.getAttribute("data-client-id"):null,n=t?t.src:window.location.origin,s=n.substring(0,n.lastIndexOf("/"));if(!e)return;let o={},a={},i=[];const r=crypto.randomUUID(),c="akula_node_sig_v3.2",l=/checkout|payment|order-received|paypal|stripe/i;let d=new Set;function u(){if(!a.patterns||!a.patterns.globalVars)return;const t=o.whitelist&&o.whitelist.globals?o.whitelist.globals:[];a.patterns.globalVars.forEach(e=>{t.includes(e)||!window.hasOwnProperty(e)&&!window[e]||d.has(e)||(d.add(e),m("global_var_detected",{detail:e},"log"))})}function p(t){if(function(t){if(!o.whitelist)return!1;const e=o.whitelist;let n=t;for(;n;){if(e.selectors&&e.selectors.some(t=>n.matches&&n.matches(t)))return!0;n=n.parentElement}return!!("SCRIPT"===t.tagName&&t.src&&e.scriptSrc&&e.scriptSrc.some(e=>t.src.includes(e)))||!!("IFRAME"===t.tagName&&t.src&&e.iframeHosts&&e.iframeHosts.some(e=>t.src.includes(e)))}(t))return;if("SCRIPT"===t.tagName&&t.src&&a.patterns.scriptSrcPatterns.some(e=>t.src.includes(e)))return void f(t,"script_src_match",t.src);if("IFRAME"===t.tagName&&t.src&&a.patterns.iframeSrcPatterns.some(e=>t.src.includes(e)))return void f(t,"iframe_src_match",t.src);const e=t.id;if(e&&a.patterns.ids.includes(e))return void f(t,"id_match",e);const n="string"==typeof t.className?t.className:"";if(n&&a.patterns.classNames.some(t=>n.includes(t)))f(t,"class_match",n);else if(o.layers.domShield){const e=window.getComputedStyle(t);if(("fixed"===e.position||"absolute"===e.position)&&parseInt(e.zIndex)>2e3){const e=t.innerText||"";a.patterns.textPatterns.some(t=>e.includes(t))&&f(t,"heuristic_overlay",e.substring(0,50))}}}function f(t,e,n){if("report-only"!==o.mode)try{t.remove(),m(e,{detail:n,tag:t.tagName},"blocked")}catch(t){}else m(e,{detail:n,tag:t.tagName},"log")}function m(t,e,n){i.push({ts:Date.now(),session_id:r,type:t,details:e,action:n,url:window.location.href}),i.length>=5&&h()}function h(){if(!i.length||!o.reporting.endpoint)return;const t=JSON.stringify({clientId:e,events:i});navigator.sendBeacon?navigator.sendBeacon(o.reporting.endpoint,t):fetch(o.reporting.endpoint,{method:"POST",body:t,keepalive:!0}).catch(()=>{}),i=[]}!async function(){try{const t=await fetch(`${s}/configs/config-client-${e}.json`);if(!t.ok)throw new Error("Config Unreachable");if(o=await t.json(),!o.enabled)return;if(l.test(window.location.href)&&"active-checkout"!==o.mode)return;await async function(){const t=Date.now(),e=localStorage.getItem(c);if(e){const n=JSON.parse(e);if(t-n.ts<108e5)return void(a=n.data)}const n=await fetch(`${s}/signatures.json`);a=await n.json(),localStorage.setItem(c,JSON.stringify({ts:t,data:a}))}(),o.layers.static&&(new MutationObserver(t=>{t.forEach(t=>{t.addedNodes.forEach(t=>{1===t.nodeType&&p(t)})})}).observe(document.documentElement,{childList:!0,subtree:!0}),document.querySelectorAll("*").forEach(p)),o.layers.behavioral&&function(){const t=Element.prototype.attachShadow;Element.prototype.attachShadow=function(e){const n=t.apply(this,arguments);return new MutationObserver(t=>{t.forEach(t=>t.addedNodes.forEach(t=>{1===t.nodeType&&p(t)}))}).observe(n,{childList:!0,subtree:!0}),n}}(),o.reporting&&o.reporting.endpoint&&setInterval(h,o.reporting.batchIntervalMs||1e4),function(){if(!a.patterns.adBlockBaitClasses)return;const t=document.createElement("div");t.className=a.patterns.adBlockBaitClasses.join(" "),t.style.cssText="width: 1px !important; height: 1px !important; position: absolute !important; left: -9999px !important;",document.body.appendChild(t),setTimeout(()=>{(0===t.offsetHeight||"none"===t.style.display)&&m("extension_adblock_detected",{detail:"Bait Hidden"},"warn"),t.remove()},100)}(),setInterval(u,2e3)}catch(t){}}()}();