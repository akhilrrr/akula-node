!function(){"use strict";const t=document.currentScript,e=t?t.getAttribute("data-client-id"):null,n=t?t.src:window.location.origin,o=n.substring(0,n.lastIndexOf("/")),s="Akula Node:";if(!e)return void console.warn(`${s} Missing Client ID`);let i={},r={},a=[];const c=crypto.randomUUID(),l="akula_node_sig_v3.2",d=/checkout|payment|order-received|paypal|stripe/i;let u=new Set;function p(){if(!r.patterns||!r.patterns.globalVars)return;const t=i.whitelist&&i.whitelist.globals?i.whitelist.globals:[];r.patterns.globalVars.forEach(e=>{t.includes(e)||!window.hasOwnProperty(e)&&!window[e]||u.has(e)||(u.add(e),h("global_var_detected",{detail:e},"log"))})}function f(t){if(function(t){if(!i.whitelist)return!1;const e=i.whitelist;let n=t;for(;n;){if(e.selectors&&e.selectors.some(t=>n.matches&&n.matches(t)))return!0;n=n.parentElement}if("SCRIPT"===t.tagName&&t.src&&e.scriptSrc&&e.scriptSrc.some(e=>t.src.includes(e)))return!0;if("IFRAME"===t.tagName&&t.src&&e.iframeHosts&&e.iframeHosts.some(e=>t.src.includes(e)))return!0;return!1}(t))return;if("SCRIPT"===t.tagName&&t.src&&r.patterns.scriptSrcPatterns.some(e=>t.src.includes(e)))return void m(t,"script_src_match",t.src);if("IFRAME"===t.tagName&&t.src&&r.patterns.iframeSrcPatterns.some(e=>t.src.includes(e)))return void m(t,"iframe_src_match",t.src);const e=t.id;if(e&&r.patterns.ids.includes(e))return void m(t,"id_match",e);const n="string"==typeof t.className?t.className:"";if(n&&r.patterns.classNames.some(t=>n.includes(t)))m(t,"class_match",n);else if(i.layers.domShield){const e=window.getComputedStyle(t);if(("fixed"===e.position||"absolute"===e.position)&&parseInt(e.zIndex)>2e3){const e=t.innerText||"";r.patterns.textPatterns.some(t=>e.includes(t))&&m(t,"heuristic_overlay",e.substring(0,50))}}}function m(t,e,n){if("report-only"!==i.mode)try{t.remove(),h(e,{detail:n,tag:t.tagName},"blocked")}catch(t){}else h(e,{detail:n,tag:t.tagName},"log")}function h(t,e,n){a.push({ts:Date.now(),session_id:c,type:t,details:e,action:n,url:window.location.href}),a.length>=1&&g()}function g(){if(!a.length||!i.reporting.endpoint)return;const t=JSON.stringify({clientId:e,events:a});navigator.sendBeacon?navigator.sendBeacon(i.reporting.endpoint,t):fetch(i.reporting.endpoint,{method:"POST",body:t,keepalive:!0}).catch(()=>{}),a=[]}!async function(){try{const t=await fetch(`${o}/configs/config-client-${e}.json`);if(!t.ok)throw new Error("Config Unreachable");if(i=await t.json(),!i.enabled)return void console.log(`${s} Disabled.`);if(d.test(window.location.href)&&"active-checkout"!==i.mode)return void console.log(`${s} Standing By (Sensitive Zone)`);await async function(){const t=Date.now(),e=localStorage.getItem(l);if(e){const n=JSON.parse(e);if(t-n.ts<108e5)return void(r=n.data)}const n=await fetch(`${o}/signatures.json`);r=await n.json(),localStorage.setItem(l,JSON.stringify({ts:t,data:r}))}(),i.layers.static&&(new MutationObserver(t=>{t.forEach(t=>{t.addedNodes.forEach(t=>{1===t.nodeType&&f(t)})})}).observe(document.documentElement,{childList:!0,subtree:!0}),document.querySelectorAll("*").forEach(f)),i.layers.behavioral&&function(){const t=Element.prototype.attachShadow;Element.prototype.attachShadow=function(e){const n=t.apply(this,arguments);return new MutationObserver(t=>{t.forEach(t=>t.addedNodes.forEach(t=>{1===t.nodeType&&f(t)}))}).observe(n,{childList:!0,subtree:!0}),n}}(),i.reporting&&i.reporting.endpoint&&setInterval(g,i.reporting.batchIntervalMs||1e4),function(){if(!r.patterns.adBlockBaitClasses)return;const t=document.createElement("div");t.className=r.patterns.adBlockBaitClasses.join(" "),t.style.cssText="width: 1px !important; height: 1px !important; position: absolute !important; left: -9999px !important;",document.body.appendChild(t),setTimeout(()=>{(0===t.offsetHeight||"none"===t.style.display)&&h("extension_adblock_detected",{detail:"Bait Hidden"},"warn"),t.remove()},100)}(),setInterval(p,2e3)}catch(t){console.warn(`${s} Init Error`,t)}}()}();