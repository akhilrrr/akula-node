!function(){"use strict";const t=document.currentScript,e=t?t.getAttribute("data-client-id"):null,n=t?t.src:window.location.origin,o=n.substring(0,n.lastIndexOf("/")),a="Akula Node:";if(!e)return void console.warn(`${a} Missing Client ID`);let s={},r={},i=[];const c=crypto.randomUUID(),l="akula_node_sig_v3.2",d=/checkout|payment|order-received|paypal|stripe/i;let u=new Set;function p(){if(!r.patterns||!r.patterns.globalVars)return;const t=s.whitelist&&s.whitelist.globals?s.whitelist.globals:[];r.patterns.globalVars.forEach(e=>{t.includes(e)||!window.hasOwnProperty(e)&&!window[e]||u.has(e)||(u.add(e),m("global_var_detected",{detail:e},"log"))})}function f(t){if(!t||1!==t.nodeType||t._akula_reported)return;if(function(t){if(!s.whitelist)return!1;const e=s.whitelist;let n=t;for(;n;){if(e.selectors&&e.selectors.some(t=>n.matches&&n.matches(t)))return!0;n=n.parentElement}if("SCRIPT"===t.tagName&&t.src&&e.scriptSrc&&e.scriptSrc.some(e=>t.src.includes(e)))return!0;if("IFRAME"===t.tagName&&t.src&&e.iframeHosts&&e.iframeHosts.some(e=>t.src.includes(e)))return!0;return!1}(t))return;let e=!1,n="",o="";"SCRIPT"===t.tagName&&t.src&&r.patterns.scriptSrcPatterns.some(e=>t.src.includes(e))&&(e=!0,n="script_src_match",o=t.src),!e&&"IFRAME"===t.tagName&&t.src&&r.patterns.iframeSrcPatterns.some(e=>t.src.includes(e))&&(e=!0,n="iframe_src_match",o=t.src);const a=t.id;!e&&a&&r.patterns.ids.includes(a)&&(e=!0,n="id_match",o=a);const i="string"==typeof t.className?t.className:"";if(!e&&i&&r.patterns.classNames.some(t=>i.includes(t))&&(e=!0,n="class_match",o=i),!e&&s.layers.domShield){const a=window.getComputedStyle(t);if(("fixed"===a.position||"absolute"===a.position)&&parseInt(a.zIndex)>2e3){const a=t.innerText||"";r.patterns.textPatterns.some(t=>a.includes(t))&&(e=!0,n="heuristic_overlay",o=a.substring(0,50))}}e&&(t._akula_reported=!0,function(t,e,n){if(t._akula_reported=!0,"report-only"===s.mode)return void m(e,{detail:n,tag:t.tagName},"log");try{t.parentNode&&"BODY"!==t.tagName&&"HTML"!==t.tagName&&(t.remove(),m(e,{detail:n,tag:t.tagName},"blocked"))}catch(t){}}(t,n,o))}function m(t,e,n){i.push({ts:Date.now(),session_id:c,type:t,details:e,action:n,url:window.location.href}),i.length>=1&&h()}function h(){if(!i.length||!s.reporting.endpoint)return;const t=JSON.stringify({clientId:e,events:i});navigator.sendBeacon?navigator.sendBeacon(s.reporting.endpoint,t):fetch(s.reporting.endpoint,{method:"POST",body:t,keepalive:!0}).catch(()=>{}),i=[]}!async function(){try{const t=await fetch(`${o}/configs/config-client-${e}.json`);if(!t.ok)throw new Error("Config Unreachable");if(s=await t.json(),!s.enabled)return void console.log(`${a} Disabled.`);if(d.test(window.location.href)&&"active-checkout"!==s.mode)return void console.log(`${a} Standing By (Sensitive Zone)`);await async function(){const t=Date.now(),e=localStorage.getItem(l);if(e){const n=JSON.parse(e);if(t-n.ts<108e5)return void(r=n.data)}const n=await fetch(`${o}/signatures.json`);r=await n.json(),localStorage.setItem(l,JSON.stringify({ts:t,data:r}))}(),s.layers.static&&(new MutationObserver(t=>{t.forEach(t=>{t.addedNodes.forEach(t=>{1===t.nodeType&&f(t)})})}).observe(document.documentElement,{childList:!0,subtree:!0}),document.querySelectorAll("*").forEach(f)),s.layers.behavioral&&function(){const t=Element.prototype.attachShadow;Element.prototype.attachShadow=function(e){const n=t.apply(this,arguments);return new MutationObserver(t=>{t.forEach(t=>t.addedNodes.forEach(t=>{1===t.nodeType&&f(t)}))}).observe(n,{childList:!0,subtree:!0}),n}}(),s.reporting&&s.reporting.endpoint&&setInterval(h,s.reporting.batchIntervalMs||1e4),function(){if(!r.patterns||!r.patterns.adBlockBaitClasses)return;const t=document.createElement("div");t.className=r.patterns.adBlockBaitClasses.join(" "),t.style.cssText="width: 1px !important; height: 1px !important; position: absolute !important; left: -9999px !important;",document.body.appendChild(t),setTimeout(()=>{(0===t.offsetHeight||"none"===t.style.display)&&m("extension_adblock_detected",{detail:"Bait Hidden"},"warn"),t.remove()},100)}(),setInterval(p,2e3)}catch(t){console.warn(`${a} Init Error`,t)}}()}();